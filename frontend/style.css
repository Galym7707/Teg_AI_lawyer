/* Reset */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%}
:root{
  --bg1:#667eea; --bg2:#764ba2;
  --ink:#333; --ink-d:#2c3e50; --muted:#666;
  --panel:#fff; --panel-2:#f8f9fa; --panel-3:#e9ecef;
}

/* Base */
body{
  font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
  background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
  color:var(--ink);
  line-height:1.6;
  min-height:100dvh; /* динамический вьюпорт для мобилок */
}

.app-container{
  display:flex; flex-direction:column;
  min-height:100dvh;
  width:100%;
  max-width:1200px; /* на десктопе ограничим, но… */
  margin:0 auto;
  background:rgba(255,255,255,.95);
  backdrop-filter:blur(10px);
  box-shadow:0 20px 40px rgba(0,0,0,.08);
  padding-inline:clamp(8px,2vw,24px); /* …на мобиле почти во весь экран */
}

/* Header */
.app-header{
  background:linear-gradient(135deg,#2c3e50 0%,#34495e 100%);
  color:#fff;
  padding:clamp(16px,3.6vw,32px) clamp(8px,2vw,24px);
  text-align:center;
  position:relative; overflow:hidden;
}
.app-header::before{
  content:"";position:absolute;inset:0;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="g" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23g)"/></svg>');
  opacity:.3
}
.header-content{position:relative;z-index:1}
.logo{display:flex;align-items:center;justify-content:center;gap:.75rem;margin-bottom:.25rem}
.logo-icon{font-size:2.2rem}
.logo h1{font-size:clamp(22px,5.5vw,40px);font-weight:700;background:linear-gradient(45deg,#fff,#f0f0f0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.subtitle{font-size:clamp(12px,3.6vw,17px);opacity:.9}

/* Chat layout */
.chat-container{flex:1;display:flex;flex-direction:column;min-height:calc(100dvh - 120px)}
.chat-messages{
  flex:1; overflow-y:auto; scroll-behavior:smooth;
  padding:clamp(10px,3.2vw,24px);
}

/* Welcome card */
.welcome-message{
  width:100%;
  max-width:unset; /* растягиваем на всю ширину мобилки */
  margin:0 auto;
  padding:clamp(14px,3.6vw,24px);
  text-align:center;
  background:linear-gradient(135deg,var(--panel-2) 0%,var(--panel-3) 100%);
  border:1px solid rgba(0,0,0,.06);
  border-radius:16px;
  box-shadow:0 8px 24px rgba(0,0,0,.06);
}
.welcome-icon{font-size:2rem;margin-bottom:.5rem}
.welcome-message h2{font-size:clamp(18px,4.6vw,28px);margin:.25rem 0 .5rem;color:var(--ink-d);font-weight:600}
.welcome-message p{font-size:clamp(14px,3.8vw,17px);color:var(--muted);margin-bottom:clamp(12px,3vw,20px)}

.example-questions h3{font-size:clamp(14px,3.8vw,18px);margin-bottom:.75rem;color:var(--ink-d);font-weight:600}
.question-tags{display:flex;flex-wrap:wrap;gap:.6rem;justify-content:center}
.question-tag{
  background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
  color:#fff;padding:.6rem 1rem;border-radius:22px;cursor:pointer;
  font-size:clamp(13px,3.6vw,14px);font-weight:600;
  transition:transform .15s ease, box-shadow .15s ease;
  box-shadow:0 4px 12px rgba(102,126,234,.25)
}
.question-tag:active{transform:scale(.98)}

/* Bubbles */
.message{
  margin-bottom:1rem;
  padding:clamp(12px,3.2vw,16px);
  border-radius:16px;
  max-width:860px;
  width:100%;           /* во весь контентный столбец */
  box-shadow:0 3px 12px rgba(0,0,0,.08);
  overflow-wrap:anywhere; /* ЛЮБЫЕ длинные куски не вылезут */
  word-break:break-word;
}
.message.user{
  background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
  color:#fff;
  margin-left:auto; border-bottom-right-radius:6px
}
.message.bot{
  background:linear-gradient(135deg,var(--panel-2) 0%,var(--panel-3) 100%);
  color:var(--ink); margin-right:auto; border-bottom-left-radius:6px;
  border:1px solid rgba(0,0,0,.05)
}
.message.bot h3{color:var(--ink-d);margin:1rem 0 .5rem;font-size:1.05rem;font-weight:700}
.message.bot p{margin:.35rem 0}
.message.bot ul{margin:.4rem 0 .6rem;padding-left:1.2rem}
.message.bot li{margin:.25rem 0}
.message.bot strong{color:var(--ink-d)}
/* вывод шаблонов / преформатированного текста */
.message pre, .message code{
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
}
.message pre{
  white-space:pre-wrap; /* переносим строки внутри шаблона */
  background:#fff;border:1px solid #eee;border-radius:10px;
  padding:.75rem;margin:.5rem 0;overflow:auto;max-width:100%
}

/* Input */
.chat-input-container{
  padding:clamp(10px,3vw,20px);
  padding-bottom:calc(clamp(10px,3vw,20px) + env(safe-area-inset-bottom)); /* для iOS-вырезов */
  background:linear-gradient(135deg,var(--panel-2) 0%,var(--panel-3) 100%);
  border-top:1px solid rgba(0,0,0,.08);
}
.chat-input{
  display:flex;align-items:flex-end;gap:.75rem;
  background:#fff;border-radius:22px;
  padding:.7rem 1rem;border:2px solid transparent;
  box-shadow:0 6px 24px rgba(0,0,0,.08); transition:border-color .2s, box-shadow .2s
}
.chat-input:focus-within{border-color:var(--bg1); box-shadow:0 8px 28px rgba(102,126,234,.18)}
.chat-input textarea{
  flex:1;border:none;outline:none;resize:none;
  font:inherit;font-size:clamp(14px,4vw,16px);line-height:1.5;
  min-height:24px;max-height:40dvh;background:transparent
}
.chat-input textarea::placeholder{color:#999}
.send-button{
  background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
  color:#fff;border:none;border-radius:50%;
  width:44px;height:44px;display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:transform .1s ease, box-shadow .1s ease;
  box-shadow:0 4px 14px rgba(102,126,234,.35)
}
.send-button:active{transform:scale(.96)}

.input-footer{text-align:center;margin-top:.6rem}
.disclaimer{font-size:.85rem;color:#666;font-style:italic}

/* Loader */
.loading-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.5);
  display:none;align-items:center;justify-content:center;flex-direction:column;z-index:1000;backdrop-filter:blur(4px)
}
.loading-overlay.show{display:flex}
.loading-spinner{width:50px;height:50px;border:4px solid rgba(255,255,255,.3);border-top:4px solid #fff;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}
@keyframes spin{to{transform:rotate(360deg)}}

/* Narrow screens specific */
@media (max-width:768px){
  .app-container{max-width:100%;}                /* никаких «рамок» по бокам */
  .chat-messages{padding:12px}
  .welcome-message{padding:14px}
  .message{max-width:100%}                        /* пузыри — на всю колонку */
  .question-tags{flex-direction:column;align-items:stretch}
  .question-tag{width:100%;text-align:center;max-width:none}
}

/* nice scrollbar */
.chat-messages::-webkit-scrollbar{width:6px}
.chat-messages::-webkit-scrollbar-track{background:rgba(0,0,0,.08);border-radius:3px}
.chat-messages::-webkit-scrollbar-thumb{background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);border-radius:3px}
.chat-messages::-webkit-scrollbar-thumb:hover{filter:brightness(.95)}

/* === Compact readable answer on mobile === */
.message.bot {
  line-height: 1.5;
}
.message.bot h3 { 
  margin: 14px 0 8px; 
  font-size: 1.05rem; 
  color: var(--ink-d);
  font-weight: 700;
}
.message.bot p { 
  margin: 0 0 10px; 
  line-height: 1.45; 
}
.message.bot ul { 
  margin: 8px 0 8px 20px; 
  padding: 0; 
}
.message.bot li { 
  margin: 6px 0; 
}
.message.bot li p { 
  margin: 0; 
}     /* убираем лишний отступ, если LLM вложил <p> внутрь <li> */
.message.bot .muted { 
  color: #6b7280; 
  font-size: .95em; 
}
.message.bot pre.code-block {
  white-space: pre-wrap;      /* переносы внутри шаблонов */
  word-break: break-word;
  font-size: .95em;
  line-height: 1.35;
  padding: 12px;
}

/* скрыть пустые элементы, которые иногда генерит LLM */
.message.bot p:empty,
.message.bot h3:empty,
.message.bot li:empty { display: none; }

/* ширина на телефонах – во всю, без «лишних полей» по бокам */
@media (max-width: 640px) {
  .app-container { padding: 8px; }
  .chat-container { width: 100%; max-width: none; margin: 0; padding: 0 8px; }
  .chat-messages { padding: 6px 0 96px; }
  .message { margin: 10px 0; border-radius: 14px; }
  .message.bot { padding: 14px; }
  .message.user { padding: 10px 12px; }
  .chat-input-container { padding: 8px; }
  .chat-input textarea { font-size: 16px; }
}


